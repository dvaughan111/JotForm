<!DOCTYPE html>
<html>
<head>
    <style>
        body {
            font-family: Helvetica, Arial, sans-serif;
            padding: 10px;
            margin: 0;
        }

        .field-group {
            border: 1px solid #ddd;
            padding: 15px;
            margin-bottom: 20px;
            border-radius: 8px;
            background-color: #f9f9f9;
            position: relative;
            padding-bottom: 25px;
        }

        .label {
            font-weight: bold;
            margin-bottom: 5px;
            display: block;
        }

        .date-field,
        .text-field {
            display: block;
            margin-bottom: 10px;
            padding: 8px;
            border: 1px solid #ccc;
            border-radius: 4px;
            box-sizing: border-box;
            font-size: 14px;
            line-height: 1.5;
        }

        .date-field {
            width: calc(100% - 22px);
            max-width: 180px;
        }

        .text-field {
            width: 100%;
            max-width: 370px;
            min-height: 100px;
            resize: vertical;
            overflow: auto;
        }

        .add-button {
            background-color: #4CAF50;
            color: white;
            padding: 10px 15px;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            font-size: 16px;
            margin-bottom: 20px;
            display: block;
            width: fit-content;
        }

        .add-button:hover {
            background-color: #45a049;
        }

        .remove-button {
            background-color: #f44336;
            color: white;
            padding: 5px 10px;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            font-size: 12px;
            position: absolute;
            bottom: 5px;
            left: 15px;
        }

        .remove-button:hover {
            background-color: #da190b;
        }
    </style>
</head>
<body>
    <button type="button" class="add-button">Add Date + Text Field</button>
    <div id="fields-container">
        </div>

    <script>
        console.log('Widget script started.'); // Log 1

        // Dynamically load the JotformCustomWidget.min.js script
        const jotformWidgetScript = document.createElement('script');
        jotformWidgetScript.src = 'https://js.jotform.com/JotformCustomWidget.min.js';
        jotformWidgetScript.onload = function() {
            console.log('JotformCustomWidget.min.js loaded successfully. JFCustomWidget:', typeof JFCustomWidget); // Log 2

            // This entire block will only run AFTER JotformCustomWidget.min.js has loaded
            document.addEventListener('DOMContentLoaded', function() {
                console.log('DOMContentLoaded fired. Widget initialization starting.'); // Log 3

                let fieldCounter = 0;
                const fieldsContainer = document.getElementById('fields-container');
                const addButton = document.querySelector('.add-button');

                function createFieldGroup(dateValue = '', textValue = '') {
                    fieldCounter++;
                    const fieldGroup = document.createElement('div');
                    fieldGroup.className = 'field-group';
                    fieldGroup.dataset.id = fieldCounter;

                    fieldGroup.innerHTML = `
                        <label for="date_${fieldCounter}" class="label">Date <span class="math-inline">\{fieldCounter\}\:</label\>
